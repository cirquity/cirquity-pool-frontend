/*!
 * Cirquity - Cirquity v0.1.0 (https://cirquity.com)
 * Copyright 2020-2021 The Cirquity Developers
 * Licensed under MIT (https://github.com/cirquity/cirquity-pool/blob/master/LICENSE)
 */

let currentPage,lastStats,xhrBlockExplorers,xhrMergedApis,mergedStats={},xhrLiveStats={},blockExplorers={},mergedApis={},numberFormatter=new Intl.NumberFormat("en-US");!function(e){e((function(){e(window).on("scroll load",(function(){e(window).scrollTop()>5?e(".navbar").addClass("active"):e(".navbar").removeClass("active"),e(window).scrollTop()>1e3?e("#scrollTop").addClass("active"):e("#scrollTop").removeClass("active")})),e("#scrollTop").on("click",(function(t){t.preventDefault(),e("html, body").animate({scrollTop:0},1e3)})),xhrBlockExplorers&&xhrBlockExplorers.abort(),xhrMergedApis&&xhrMergedApis.abort(),"undefined"!=typeof email&&email&&e("#detailsMenu").append('<a class="dropdown-item translatable" href="mailto:'+email+'" target="_blank" data-translate-key="contactUs">Contact us</a>'),"undefined"!=typeof telegram&&telegram&&e("#detailsMenu").append('<a class="dropdown-item translatable" href="'+telegram+'" target="_blank" data-translate-key="telegram">Telegram</a>'),"undefined"!=typeof discord&&discord&&e("#detailsMenu").append('<a class="dropdown-item translatable" href="'+discord+'" target="_blank" data-translate-key="discord">Discord</a>'),"undefined"!=typeof facebook&&facebook&&e("#detailsMenu").append('<a class="dropdown-item translatable" href="'+facebook+'" target="_blank" data-translate-key="Facebook">Facebook</a>'),e.loadTranslations(),e.fetchBlockExplorers()})),e.fetchBlockExplorers=function(){let t=api+"/block_explorers";xhrBlockExplorers=e.ajax({url:t,dataType:"json",cache:"false"}).done((function(e){blockExplorers=e})),t=api+"/get_apis",xhrMergedApis=e.ajax({url:t,dataType:"json",cache:"false"}).done((function(t){mergedApis=t,e.loadLiveStats()}))},e.loadLiveStats=function(t){let a=api+"/stats",n=e.getCurrentAddress();n&&(a=a+"?address="+encodeURIComponent(n)),xhrLiveStats[parentCoin]&&xhrLiveStats[parentCoin].abort(),e.get(a,(function(t){e.updateLiveStats(t,parentCoin),currentPage.update(),e.fetchLiveStats(api,parentCoin)})),Object.keys(mergedApis).some(t=>{let a=`${mergedApis[t].api}/stats`;e.get(a,(function(a){e.updateLiveStats(a,t),currentPage.update(),e.fetchLiveStats(mergedApis[t].api,t)}))})},e.fetchLiveStats=function(t,a){let n=t+"/live_stats",o=e.getCurrentAddress(a);o&&(n=n+"?address="+encodeURIComponent(o)),xhrLiveStats[a]=e.ajax({url:n,dataType:"json",cache:"false"}).done((function(t){e.updateLiveStats(t,a)})).always((function(){e.fetchLiveStats(t,a)}))},e.getCurrentAddress=function(t){let a="";if(t){a=e.getUrlParam(t,0)||docCookies.getItem(`mining_address_${t}`)}return a},e.getUrlParam=function(t,a){let n=a;return window.location.href.indexOf(t)>-1&&(n=e.getUrlLets()[t]),n},e.getUrlLets=function(){let e={};window.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi,(function(t,a,n){e[a]=n}));return e},e.updateLiveStats=function(t,a){e.pulseLiveUpdate(),a!==parentCoin?mergedStats[a]=t:(lastStats=t,lastStats&&lastStats.pool&&"-1"===lastStats.pool.totalMinersPaid.toString()&&(lastStats.pool.totalMinersPaid=0),e.updateIndex()),currentPage&&currentPage.update(a)},e.updateIndex=function(){e.updateText("coinSymbol",lastStats.config.symbol),e.updateText("g_networkHashrate",e.getReadableHashRateString(lastStats.network.difficulty/lastStats.config.coinDifficultyTarget)+"/sec"),e.updateText("g_poolHashrate",e.getReadableHashRateString(lastStats.pool.hashrate)+"/sec"),e.updateText("g_poolHashrateSolo",e.getReadableHashRateString(lastStats.pool.hashrateSolo)+"/sec"),lastStats.miner&&lastStats.miner.hashrate?e.updateText("g_userHashrate",e.getReadableHashRateString(lastStats.miner.hashrate)+"/sec"):e.updateText("g_userHashrate","N/A"),e.updateText("poolVersion",lastStats.config.version)},e.updateTextClasses=function(e,t){let a=document.getElementsByClassName(e);if(a)for(let e=0;e<a.length;e++){let n=a[e];n&&n.textContent!==t&&(n.textContent=t)}},e.updateText=function(e,t){let a=document.getElementById(e);return a&&a.textContent!==t&&(a.textContent=t),a},e.pulseLiveUpdate=function(){let t=e("#statsUpdated");t.css({opacity:1,transition:"opacity 100ms ease-out"}),setTimeout((function(){t.css({opacity:0,transition:"opacity 7000ms linear"})}),500)},e.getReadableHashRateString=function(e){let t=0;for(;e>1e3;)e/=1e3,t++;return"number"!=typeof e&&(e=0),e.toFixed(2)+[" H"," KH"," MH"," GH"," TH"," PH"][t]},e.getReadableTime=function(t){let a=[[60,"second"],[60,"minute"],[24,"hour"],[7,"day"],[4,"week"],[12,"month"],[1,"year"]],n=t;for(let t=0;t<a.length;t++){if(n<a[t][0])return e.formatAmounts(n,a[t][1]);n/=a[t][0]}return e.formatAmounts(n,a[a.length-1][1])},e.floatToString=function(e){return e.toFixed(6).replace(/[0\.]+$/,"")},e.formatDate=function(e){return e?new Date(1e3*parseInt(e)).toLocaleString():""},e.formatAmounts=function(t,a){let n=Math.round(t);return a+=n>1?"s":"",e.getTranslation(a)&&(a=e.getTranslation(a)),n+" "+a},e.formatNumber=function(e,t){if(""!==e){let a="",n="";for((e=e.split(t).join(""))<0&&(e=-e,n="-");e>=1e3;){let n=e%1e3;""!==a&&(a=t+a),a=0===n?"000"+a:n<10?"00"+n+a:n<100?"0"+n+a:n+a,e=parseInt(e/1e3)}return a=""!==a?n+e+t+a:n+e,a}return""},e.formatPaymentLink=function(t,a){return'<a target="_blank" href="'+e.getTransactionUrl(t,a)+'">'+t+"</a>"},e.getReadableCoin=function(t,a,n,o,r=!1){let s=e.getCoinDecimalPlace(t),l=parseFloat((parseInt(a||0)/lastStats.config.coinUnits).toFixed(n||s));return r?Number(l.toString()+(o?"":" "+t.config.symbol)):e.localizeNumber(l)+(o?"":" "+t.config.symbol)},e.getCoinDecimalPlace=function(e){return"undefined"!=typeof coinDecimalPlaces?coinDecimalPlaces:e.config.coinDecimalPlaces?e.config.coinDecimalPlaces:e.config.coinUnits.toString().length-1},e.getBlockchainUrl=function(e,t){if(t&&blockExplorers)return blockExplorers[t.config.coin].blockchainExplorer.replace("{symbol}",t.config.symbol.toLowerCase()).replace("{id}",e)},e.getTransactionUrl=function(e,t){if(t&&blockExplorers)return blockExplorers[t.config.coin].transactionExplorer.replace("{symbol}",t.config.symbol.toLowerCase()).replace("{id}",e)},e.formatBlockLink=function(t,a){return'<a target="_blank" href="'+e.getBlockchainUrl(t,a)+'">'+t+"</a>"},e.formatLuck=function(e,t,a=!1){let n=t;if(lastStats.config.slushMiningEnabled){lastStats.config.blockTime,lastStats.config.weight,Math.pow(Math.E,-lastStats.config.blockTime/lastStats.config.weight)}let o=Math.round(n/e*100);return o?o<=100?`<span class="luckGood">${o}%&nbsp;</span>`+(!0===a?'<span class="fa fa-user luckGood" title="Solo Mined"></span>':""):o>=101&&o<=150?`<span class="luckMid">${o}%&nbsp;</span>`+(!0===a?'<span class="fa fa-user luckMid" title="Solo Mined"></span>':""):`<span class="luckBad">${o}%&nbsp;</span>`+(!0===a?'<span class="fa fa-user luckBad" title="Solo Mined"></span>':""):'<span class="luckGood">?</span>'+(!0===a?'<span class="fa fa-user luckGood" title="Solo Mined"></span>':"")},e.sortElementList=function(e,t,a){let n=(e,t)=>e.id.toLowerCase()<t.id.toLowerCase()?-1:e.id.toLowerCase()>t.id.toLowerCase()?1:0;a&&t.length-1===Object.keys(a).length&&t.sort(n).appendTo(e)},e.sortTable=function(){let t=e(this).parents("table").eq(0),a=t.find("tr:gt(0)").toArray().sort(e.compareTableRows(e(this).index()));this.asc=!this.asc,this.asc||(a=a.reverse());for(let e=0;e<a.length;e++)t.append(a[e])},e.compareTableRows=function(t){return function(a,n){let o=e.getCellValue(a,t),r=e.getCellValue(n,t);return o||(o=0),r||(r=0),e.isNumeric(o)&&e.isNumeric(r)?o-r:o.toString().localeCompare(r.toString())}},e.getCellValue=function(t,a){return e(t).children("td").eq(a).data("sort")},e.localizeNumber=function(e){return numberFormatter.format(e)},e.getPoolHost=function(){return"undefined"!=typeof poolHost?poolHost:lastStats.config.poolHost?lastStats.config.poolHost:window.location.hostname},e.isEmail=function(e){return/^([a-zA-Z0-9_.+-])+\@(([a-zA-Z0-9-])+\.)+([a-zA-Z0-9]{2,4})+$/.test(e)},e.renderAdminTemplate=function(t,a,n){let o=e(a).html(),r=Handlebars.compile(o)(t);e(n).html(r)},e.truncate=function(e,t,a){if(e.length<=t)return e;let n=t-(a=a||"...").length,o=Math.ceil(n/2),r=Math.floor(n/2);return e.substr(0,o)+a+e.substr(e.length-r)},e.titleCase=function(e){let t=e.toLowerCase().split(" ");for(let e=0;e<t.length;e++)t[e]=t[e].charAt(0).toUpperCase()+t[e].substring(1);return t.join(" ")},e.fn.update=function(e){let t=this[0];return t&&t.textContent!==e&&(t.textContent=e),this}}(jQuery);let docCookies={getItem:function(e){return decodeURIComponent(document.cookie.replace(new RegExp("(?:(?:^|.*;)\\s*"+encodeURIComponent(e).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*([^;]*).*$)|^.*$"),"$1"))||null},setItem:function(e,t,a,n,o,r){if(!e||/^(?:expires|max\-age|path|domain|secure)$/i.test(e))return!1;let s="";if(a)switch(a.constructor){case Number:s=a===1/0?"; expires=Fri, 31 Dec 9999 23:59:59 GMT":"; max-age="+a;break;case String:s="; expires="+a;break;case Date:s="; expires="+a.toUTCString()}return document.cookie=encodeURIComponent(e)+"="+encodeURIComponent(t)+s+(o?"; domain="+o:"")+(n?"; path="+n:"")+(r?"; secure":""),!0},removeItem:function(e,t,a){return!(!e||!this.hasItem(e))&&(document.cookie=encodeURIComponent(e)+"=; expires=Thu, 01 Jan 1970 00:00:00 GMT"+(a?"; domain="+a:"")+(t?"; path="+t:""),!0)},hasItem:function(e){return new RegExp("(?:^|;\\s*)"+encodeURIComponent(e).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=").test(document.cookie)}};