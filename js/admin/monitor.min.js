/*!
 * Cirquity - Cirquity v0.1.0 (https://cirquity.com)
 * Copyright 2020-2021 The Cirquity Developers
 * Licensed under MIT (https://github.com/cirquity/cirquity-pool/blob/master/LICENSE)
 */

!function(e){e((function(){currentPage={destroy:function(){},update:function(e){}};let t=setInterval((function(){lastStats&&(e.renderLogInfo(),e.loadTranslations(),clearInterval(t))}),10)})),e.getCheckTime=function(t){return t?e.timeago(new Date(1e3*t).toISOString()):null},e.monitoringInfoParse=function(t){console.log(t);let o={lastCheck:e.getCheckTime(t.monitoring.daemon.lastCheck)||"never",lastStatus:t.monitoring.daemon.lastStatus||"",lastFail:e.getCheckTime(t.monitoring.daemon.lastFail)||"never",lastFailResponse:t.monitoring.daemon.lastFailResponse?JSON.stringify(JSON.parse(t.monitoring.daemon.lastFailResponse),null,4)||" ":"",lastResponse:JSON.stringify(JSON.parse(t.monitoring.daemon.lastResponse),null,4)||" "},n={lastCheck:e.getCheckTime(t.monitoring.wallet.lastCheck)||"never",lastStatus:t.monitoring.wallet.lastStatus||"",lastFail:e.getCheckTime(t.monitoring.wallet.lastFail)||"never",lastFailResponse:t.monitoring.daemon.lastFailResponse?JSON.stringify(JSON.parse(t.monitoring.wallet.lastFailResponse),null,4)||" ":"",lastResponse:JSON.stringify(JSON.parse(t.monitoring.wallet.lastResponse),null,4)||" "},a={};if(t.hasOwnProperty("logs")){const o=/([A-Z])([A-Z])([a-z])|([a-z])([A-Z])/g,n=/[^a-zA-Z0-9]/g;a.logs=t.logs;for(let a in t.logs)t.logs[a].name=e.titleCase(a.replace(".log","").replace(n," ").replace(o,"$1$4 $2$3$5")),t.logs[a].changed=e.formatDate(t.logs[a].changed),t.logs[a].link=api+"/admin_log?file="+a+"&password="+docCookies.getItem("password")}return a.monitoringDaemon=o,a.monitoringWallet=n,a},e.renderLogInfo=function(t){let o=docCookies.getItem("password");o&&!t||(o=prompt("Enter admin password")),e.ajax({url:api+"/admin_monitoring",data:{password:o},dataType:"json",cache:!1,success:function(t){docCookies.setItem("password",o,1/0),e.renderAdminTemplate(e.monitoringInfoParse(t),"#monitoringInfo","#monitoringInfoView"),e("#daemonStatus").addClass("ok"===t.monitoring.daemon.lastStatus?"text-success":"text-danger"),e("#walletStatus").addClass("ok"===t.monitoring.wallet.lastStatus?"text-success":"text-danger"),e("#logTable th.sort").on("click",e.sortTable)},error:function(e){docCookies.removeItem("password")}})}}(jQuery);